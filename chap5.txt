Modified from chap4 to 5